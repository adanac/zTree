/**
 * Created by allen on 2017/3/21.
 */
var $ctx = $("#ctx").val();
var setting = {
    check: {
        enable: true,
        chkDisabledInherit: true
    },
    data: {
        simpleData: {
            enable: true
        }
    }
};

var zNodes = [
    {id: 1, pId: 0, name: "随意勾选 1", open: true},
    {id: 11, pId: 1, name: "随意勾选 1-1", open: true},
    {id: 111, pId: 11, name: "disabled 1-1-1", chkDisabled: true},
    {id: 112, pId: 11, name: "随意勾选 1-1-2"},
    {id: 12, pId: 1, name: "disabled 1-2", chkDisabled: true, checked: true, open: true},
    {id: 121, pId: 12, name: "disabled 1-2-1", checked: true},
    {id: 122, pId: 12, name: "disabled 1-2-2"},
    {id: 2, pId: 0, name: "随意勾选 2", checked: true, open: true},
    {id: 21, pId: 2, name: "随意勾选 2-1"},
    {id: 22, pId: 2, name: "随意勾选 2-2", open: true},
    {id: 221, pId: 22, name: "随意勾选 2-2-1", checked: true},
    {id: 222, pId: 22, name: "随意勾选 2-2-2"},
    {id: 23, pId: 2, name: "随意勾选 2-3"}
];

function disabledNode(e) {
    var zTree = $.fn.zTree.getZTreeObj("treeDemo"),
        disabled = e.data.disabled,
        nodes = zTree.getSelectedNodes(),
        inheritParent = false, inheritChildren = false;
    if (nodes.length == 0) {
        alert("请先选择一个节点");
    }
    if (disabled) {
        inheritParent = $("#py").attr("checked");
        inheritChildren = $("#sy").attr("checked");
    } else {
        inheritParent = $("#pn").attr("checked");
        inheritChildren = $("#sn").attr("checked");
    }

    for (var i = 0, l = nodes.length; i < l; i++) {
        zTree.setChkDisabled(nodes[i], disabled, inheritParent, inheritChildren);
    }
}

$(document).ready(function () {
    $.fn.zTree.init($("#treeDemo"), setting, zNodes);
    $("#disabledTrue").bind("click", {disabled: true}, disabledNode);
    $("#disabledFalse").bind("click", {disabled: false}, disabledNode);
});